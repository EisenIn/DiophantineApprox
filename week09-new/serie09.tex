\documentclass[12pt,a4paper]{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{graphics}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption} 
\usepackage{enumerate}
\usepackage{polynom}
\usepackage[utf8]{inputenc} 
\usepackage{utf8math}
\usepackage{xfrac}

\date{}

\usepackage[boldsans]{concmath}

\theoremstyle{plain}
\newtheorem{theorem}{Th\'eor\`eme}
\newtheorem{Sol}{Solution}
\newtheorem*{Sol*}{Solution}
\theoremstyle{definition}
\newtheorem{Ex}{Exercise}
\newtheorem{lemma}[theorem]{Lemma}


\def \N {\mathbb N}
\def \Q {\mathbb Q}
\def \R {\mathbb R}
\def \Z {\mathbb Z}
\def \K {\mathbb K}
\def \C {\mathbb C}
\def \F {\mathbb F}
\def \id {{\rm id}\,}
\def \Ker {{\rm Ker}\,}
\def \Im {{\rm Im}\,}
\def \Vect {{\rm Vect}\,}

\newcommand{\df}{\mathrel{\mathop:}=}
\newcommand{\dx}{ \ \text{d} \, x}

\newcommand{\pscal}[1]{\langle {#1} \rangle}
\DeclareMathOperator{\spa}{span}
\newcommand{\nint}[1]{\ensuremath{\lfloor#1\rceil}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%       ENABLE or DISABLE dislpay of solutions
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\newif\ifsolutions
		
		% ENABLE or DISABLE display of solutions
		\solutionstrue
		%\solutionsfalse


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%		Dont touch much, just change the correct number and date :). Based on the setup above, the solutions will be automaticelly displayed or hidden.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\newcommand{\exercise}[2]{
			\begin{Ex} #1 \end{Ex}
			\ifsolutions  \begin{Sol*} #2 \end{Sol*} \bigskip \else \bigskip  \fi
		}

		

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   Beginning of the document. Make sure to add the correct dates and numbers everywhere.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\begin{center}
{Prof. Friedrich Eisenbrand \hfill November 24th 2023}
\end{center}
	
\hrule\vspace{\baselineskip}

\begin{center}
\textbf{Diophantine approximation}

Fall 2023

\bigskip

\textbf{Set 9}
\ifsolutions{\textbf{- Solutions}} \else{} \fi
\end{center}

\hrule\vspace{\baselineskip}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   Beginning of the exercises
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    Each exercise should look like 
% 		\exercise{ Exercise }{ Solution }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\exercise{
	Let $Q \in \N$ and $\alpha_1, \alpha_2 \in \R$ be two real numbers. We denote $\nint{ \cdot }$ the nearest integer map.

	Consider the basis $B = \left\{ \begin{pmatrix} Q^2 \\ 0 \\ 0 \end{pmatrix}, \begin{pmatrix} \nint{Q^2 \alpha_1} \\ 1/Q \\ 0 \end{pmatrix}, \begin{pmatrix} \nint{Q^2 \alpha_2} \\ 0 \\ 1/Q \end{pmatrix} \right\}$ generating the lattice $\Lambda$.
	
	Let  $v \in \Lambda$ be a nonzero shortest vector of $\Lambda$ with respect to the $l^2$ norm. 
	Let its integer coordinates in $B$ be $(y, x_1, x_2)$, and set $\lambda = \| v \|_2$.

	Show that $\lambda \leq \sqrt{3}$, and that
	\begin{align*}
	\begin{cases}
		x_1 \leq \lambda \cdot Q, \\
		x_2 \leq \lambda \cdot Q,  \text{ and }\\
		| y + x_1 \alpha_1 + x_2 \alpha_2 | \leq \lambda\frac{1+ Q}{Q^2}.
	\end{cases}
	\end{align*}
	
	Fix $Q=10, \alpha_1 = \sqrt{2}, \alpha_2 = \sqrt{3}$.
	\begin{enumerate}[i)]
		\item Compute the first four steps of LLL on applied to the basis $B$. 
		Record the operations done in a unimodular matrix $P$ such that $B \cdot P$ is the matrix found.
		\item Let $P = \begin{pmatrix} 5 & -8 & 33 \\
								-6 & 2 & -5 \\
								2 & 3 & -15 \end{pmatrix}.$
		Show that $P$ is unimodular and hence that $B$ and $B \cdot P$ span the same lattice.
		\item Show that $B^{LLL} := B \cdot P$ is \emph{LLL-reduced}, with first vector $\frac{1}{10}\begin{pmatrix} 0 \\ -6 \\ 2 \end{pmatrix}$.
		\item Deduce that $0.315 \leq \lambda \leq 0.633$.
	\end{enumerate}
}
{}


\exercise{
  Let $B ∈ ℤ^{ n ×n}$ be a lattice basis and $Β= B^* ⋅ R$ be its Gram-Schmidt orthogonalization, where $R ∈ ℚ^{n ×n}$ is upper triangular with diagonal-elements being $1$. Recall the definition of potential
  \begin{displaymath}
    Φ(B) = ∏_{i=1}^n \|b_i^*\|^{2 (n-i+1)} ∈ℕ_+, 
  \end{displaymath}
  where $b_i^*$ is the $i$-th column of $B^*$. 

  \begin{enumerate}[i)]   
  \item Show that $\|b_i^* \| ≤ \|b_i\|$ for all $i ∈ \{1,\dots,n\}$, where $b_i$ denotes the $i$-th column of $B$. 
  \item Let $M$ be the largest absolute value of an entry in $B$. Show that
    \begin{displaymath}
       Φ(B) \leq ∏_{i=1}^n (\sqrt{n} M)^{2 (n-i+1)}. 
     \end{displaymath}
   \item Conclude that the number of iterations of the LLL-algorithm on input $B$ is bounded by
     \begin{displaymath}
       O(n^2 (\log n + \log M)).       
     \end{displaymath}
   \item Argue that this number of iterations is polynomial in the storage-space that is required to store the matrix $B$ in a computer. 
  \end{enumerate}
}{
	\begin{enumerate}[i)]
		\item Since $b_i^* = b_i + \sum_{j=1}^{i-1} \mu_{ji} b_j^*$ for some coefficients $\mu_{ji}$, Pythagoras' theorem gives
			\[ \| b_i^* \|_2^2 \leq \| b_i \|_2^2. \]

		\item Clearly, one has for each $i$,
			\[ \| b_i \|_2^2 \leq n M^2, \]
		which concludes given the definition of $\Phi(B)$ and question i). 

		\item Simplifying the upperbound, we have
			\[ \Phi(B) \leq (\sqrt{n}M)^{n(n-1)}. \]
		Since each step of LLL decreases the potential by a multiplicative factor, and since the potential is always integer, the number of steps is of order $\log \Phi(B) = \mathcal{O}\left(n^2 \left( \log n + \log M \right) \right)$.

		\item Each $n^2$ entry of $B$ is an integer bounded by $M$. 
		Hence, their bit representation has size bounded by $\log M$.
		Storing $B$ therefore takes space of order $n^2 \log M$.
	\end{enumerate}

}


\exercise{
  Let $Β∈ ℝ^{n ×n}$ be a non-singular matrix and $B = B^* ⋅ R$ be the Gram-Schmidt orthogonalization  of $B$. The \emph{orthogonality defect} of $B$ is the number
  \begin{displaymath}
    γ = \frac{∏_i \| b_i \|_2}{|\det(B)|}.  
  \end{displaymath}

  \begin{enumerate}
  \item Show that $γ$ is invariant under permutations of the columns. 
  \item Show that $γ = 2^{O(n^2)}$ if $B$ is LLL-reduced.
  \item  Argue, using set 8, that a shortest vector of $Λ(B)$ can be computed in time $2^{O(n^2)}$ plus  a polynomial in the input encoding of $B$. 
  \end{enumerate}
}{
	 \begin{enumerate}[i)]
		\item This is clear since the denominator of $\gamma$ was written as an absolute determinant.

		\item If $B$ is an LLL-reduce basis, then the order relations
			\[ \| b_i^* \|_2^2 \leq 2 \| b_{i+1}^* \|^2_2, \quad \text{ for each $i=1, \dots, n-1$} \]
		and the fact that $\mu_{ij}^2 \leq 1/4$ for each $i,j$ imply that 
			\begin{align*}
				\| b_i \|^2 &\leq \| b_i^* \|^2 + \frac14 \sum_{j=1}^{i-1} \| b_j^* \|^2, \\
						& \leq \| b_i^* \|^2 + \frac14 \sum_{j=1}^{i-1} 2^{i-j} \| b_i^* \|^2, \\
						& \leq \| b_i^* \|^2 \left( 1 + \frac14 (2^i -2) \right) \leq 2^{i-1} \| b_i^* \|^2 \quad \text{ for each $i=1, \dots n$} .
			\end{align*}
		The orthogonality defect may therefore be bounded by
			\[ \gamma^2 \leq 2^{n(n-1)/2} = 2^{\mathcal{O}(n^2)}, \]
		which is the required result.

		\item 
		Last set, we saw a $2^{\mathcal{O}(n \log n)}\cdot \gamma$ algorithm to solve the shortest vector problem.
		Reducing the basis before applying that algorithm adds a polynomial factor in the input encoding of $B$.
	\end{enumerate}

}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
